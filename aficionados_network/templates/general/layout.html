{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;600;700;800&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
    <script>
    document.addEventListener('htmx:configRequest', (event) => {
        event.detail.headers['X-CSRFToken'] = '{{ csrf_token }}';
    });
    </script>

    <title>{% block head_title %}Hubs & Clicks{% endblock head_title %}</title>
    {% block extra_css %}{% endblock extra_css %}
</head>

<body>
    {% include "_includes/_header.html" %}

    <div class="message-container">
        {% include "_includes/_messages.html" %}
    </div>

    <main class="main-content container-fluid py-4 px-md-5">
        <div class="row">
            
            <div class="col-12 d-lg-none mb-4">
                <h6 class="sidebar-label px-1">MIS GRUPOS</h6>
                <div class="mobile-hobby-scroll d-flex pb-2 pt-2">
                    {% for hobby in my_hobbies %}
                        <a href="{% url 'posts:hobby_hub' hobby.slug %}" class="mobile-hobby-pill position-relative text-decoration-none">
                            <div class="hobby-dot-sm bg-hubs">
                                {{ hobby.name|slice:":1"|upper }}
                            </div>
                            <span>{{ hobby.name }}</span>
                            
                            {% if request.user.is_authenticated and hobby.match_count > 0 %}
                                <span class="badge rounded-pill bg-info text-dark mobile-hobby-badge">
                                    {{ hobby.match_count }}
                                </span>
                            {% endif %}
                        </a>
                    {% empty %}
                        <small class="text-muted">Sin aficiones</small>
                    {% endfor %}
                </div>
            </div>

            <aside class="col-md-2 d-none d-md-block">
                <div class="sticky-sidebar">
                    <h6 class="sidebar-label">MIS GRUPOS</h6>
                    <div class="list-group sidebar-group shadow-sm">
                        {% for hobby in my_hobbies %}
                            <a href="{% url 'posts:hobby_hub' hobby.slug %}" 
                               class="list-group-item list-group-item-action sidebar-item d-flex justify-content-between align-items-center">
                                <div class="d-flex align-items-center">
                                    <div class="hobby-dot bg-hubs">
                                        {{ hobby.name|slice:":1"|upper }}
                                    </div>
                                    <span class="hobby-name">{{ hobby.name }}</span>
                                </div>
                                
                                {% if request.user.is_authenticated and hobby.match_count > 0 %}
                                    <span class="badge rounded-pill bg-info text-dark match-pulse sidebar-badge">
                                        {{ hobby.match_count }}
                                    </span>
                                {% endif %}
                            </a>
                        {% endfor %}
                    </div>
                </div>
            </aside>

            <div class="col-12 col-md-10">
                <div class="row mb-3">
                    <div class="col px-md-4">
                        {% block page_title %}{% endblock page_title %}
                    </div>
                </div>

                <div class="px-md-4">
                    {% block content %}
                        <p>Contenido base.</p>
                    {% endblock content %}
                </div>
            </div>

        </div>
    </main>

    {% include "_includes/_footer.html" %}

    <button id="btn-back-to-top" class="back-to-top shadow">
        <i class="bi bi-chevron-up"></i>
    </button>

    <div id="cookie-banner" class="cookie-banner">
        <div class="row align-items-center">
            <div class="col-md-7">
                <p class="cookie-text mb-md-0">
                    <i class="bi bi-cookie text-warning fs-5 me-2"></i>
                    En <strong>Hubs & Clicks</strong> utilizamos cookies para mejorar tu experiencia. 
                    Ver <a href="/politica-cookies/" class="cookie-link">pol√≠tica de privacidad</a>.
                </p>
            </div>
            <div class="col-md-5 text-md-end">
                <div class="cookie-buttons d-flex gap-2 mt-3 mt-md-0 justify-content-md-end">
                    <button id="accept-cookies" class="btn btn-hubs btn-sm text-nowrap rounded-pill px-3">
                        Aceptar todas
                    </button>
                    <button id="reject-cookies" class="btn btn-light btn-sm text-nowrap rounded-pill border px-3">
                        Solo necesarias
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{% static 'js/community-hub.js' %}"></script>
    <script src="{% static 'js/backTop.js' %}"></script>
    <script src="{% static 'js/likes.js' %}"></script>
    <script src="{% static 'js/cookies.js' %}"></script> 
   
    {% block extra_js %}{% endblock extra_js %}
</body>
</html>