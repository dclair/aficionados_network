{# 1. Cambiamos style="height: 80vh" por la clase que ya tiene el Media Query en el CSS #}
<div class="row g-0 post-modal-container">
    
    {# 2. Quitamos h-100 y usamos post-modal-image-col para controlar el alto en móvil #}
    <div class="col-lg-7 bg-black d-flex align-items-center justify-content-center post-modal-image-col">
        {% if post.image %}
            <img src="{{ post.image.url }}" class="img-fluid post-main-img" style="max-height: 100%; object-fit: contain;">
        {% endif %}
    </div>

    {# 3. Quitamos h-100 y usamos post-modal-content-col para repartir el espacio restante #}
    <div class="col-lg-5 d-flex flex-column bg-white post-modal-content-col">
        
        <div class="p-3 border-bottom d-flex align-items-center justify-content-between">
            <div class="d-flex align-items-center">
                <img src="{% if post.user.profile.profile_picture %}{{ post.user.profile.profile_picture.url }}{% else %}https://ui-avatars.com/api/?name={{ post.user.username }}{% endif %}" 
                     class="rounded-circle border me-2" style="width: 30px; height: 30px; object-fit: cover;">
                <span class="fw-bold small">@{{ post.user.username }}</span>
            </div>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>

        {# 4. Usamos la clase post-comments-scroll que tiene el fix para el dedo del iPhone #}
        <div class="flex-grow-1 p-3 post-comments-scroll" id="scroll-container-{{ post.id }}" style="background-color: #f8f9fa;">
            <div class="mb-3">
                <p class="small mb-0"><strong>{{ post.title }}</strong></p>
                <p class="text-muted small">{{ post.caption }}</p>
                <hr>
            </div>

            <div id="comments-list-{{ post.id }}"> 
                {% for comment_obj in post.comments.all reversed %}
                    {% include 'posts/partials/_comment_single.html' %}
                {% empty %}
                    <p class="text-muted small text-center py-3" id="no-comments-{{ post.id }}">
                        No hay comentarios aún.
                    </p>
                {% endfor %}
            </div>
        </div>

        <div class="p-3 border-top bg-white">
            <form hx-post="{% url 'posts:add_comment' post.id %}" 
                hx-target="#comments-list-{{ post.id }}" 
                hx-swap="afterbegin" 
                hx-on::after-request="if(event.detail.successful) { 
                    this.reset(); 
                    var noComments = document.getElementById('no-comments-{{ post.id }}');
                    if(noComments) noComments.remove();
                }"
                class="d-flex gap-2">
                {% csrf_token %}
                <input type="text" name="comment" 
                    class="form-control form-control-sm rounded-pill px-3" 
                    placeholder="Escribe un comentario..." 
                    required>
                <button type="submit" class="btn btn-hubs btn-sm rounded-circle shadow-sm">
                    <i class="bi bi-send-fill htmx-indicator-hide"></i>
                    <div class="spinner-border spinner-border-sm htmx-indicator" role="status"></div>
                </button>
            </form>
        </div>
    </div>
</div>